<html>
	<script type='text/javascript'>(function () {
	      return window.SIG_EXT = {};
	    })()
	</script>
	<head>
		<title>Garagem 88</title>
		<script>
			function onSubmit() { var aguarde = document.getElementById('aguarde'); aguarde.style.display = 'block'; } 

			function getDistanceFromLatLonInMeters(lat1,lon1) {
				var lat2 = -8.0966284;
				var lon2 = -34.9164659;

				var R = 6371; // Radius of the earth in km
				var dLat = deg2rad(lat2-lat1);  // deg2rad below
				var dLon = deg2rad(lon2-lon1); 
				var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon/2) * Math.sin(dLon/2); 
				var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
				var d = R * c; // Distance in km
				return d * 1000;
			}

			function deg2rad(deg) {
				return deg * (Math.PI/180)
			}

			function getLocation() {
			    if (navigator.geolocation) {
			        navigator.geolocation.getCurrentPosition(onPosition);
			    } else {
			       alert("Não foi possível determinar sua localização.");
			    }
			}

			function onPosition(position) {
			    var dist = getDistanceFromLatLonInMeters(position.coords.latitude,position.coords.longitude);
			    if (dist > 50) {
			    	alert("Você está muito distante para controlar sua casa. " + dist.toFixed(2).split(".").join(",") + " metros.");
			    } else {
			    	alert("Acesso liberado. " + dist.toFixed(2).split(".").join(",") + " metros.");
			    }
			}

		</script>
	</head>
	<body>
		<div id='aguarde' style='width: 100%;height: 80%; back;float: left;position: absolute;border: 0px;background-color: #FFF;top: 8%;text-align: center;font-family: monospace;font-size: 26px;display: none;'>Processando. Aguarde...</div>
		<h1 style='font-family: monospace;font-size: 40px;text-align: center;'>Garagem 88</h1>
		<form action='http://projetos.ricardoteix.com/garagem/dev/arduino/html/webduino/index.html' method='POST'  onsubmit='onSubmit()'>
			<p style='margin: 40px;'>
				<button name='buzz' value='5' style='width: 100%;height: 10%;font-family: monospace;font-size: 35px;'>Portão ( Abrir / Fechar )</button>
			</p>
			<p style='margin: 40px;'>
				<button name='buzz' value='6' style='width: 100%;height: 10%;font-family: monospace;font-size: 35px;'>Ligar Alarme</button>
			</p>
			<p style='margin: 40px;'>
				<button name='buzz' value='7' style='width: 100%;height: 10%;font-family: monospace;font-size: 35px;'>Desligar Alarme</button>
			</p>
		</form>
	</body>
</html>

